<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìš°ì£¼ì˜ ê³„ì‚°ê¸° VER.3</title>
    <link rel="stylesheet" href="styles.css">
    
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-DEW8SS3RYB"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-DEW8SS3RYB');
    </script>
    
    <!-- Firebase SDK -->
    <script type="module">
      // Import the functions you need from the SDKs you need
      import { initializeApp } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-app.js";
      import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-analytics.js";
      import { getFirestore, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-firestore.js";

      // Your web app's Firebase configuration
      // For Firebase JS SDK v7.20.0 and later, measurementId is optional
      const firebaseConfig = {
        apiKey: "AIzaSyCEzpOSkAayaxpARoZw69hAm84CQ88jZVY",
        authDomain: "work-calculator-15dcd.firebaseapp.com",
        projectId: "work-calculator-15dcd",
        storageBucket: "work-calculator-15dcd.firebasestorage.app",
        messagingSenderId: "65634532779",
        appId: "1:65634532779:web:10729f78e482db2f6426ee",
        measurementId: "G-70RR8PTRQ5"
      };

      // Initialize Firebase
      const app = initializeApp(firebaseConfig);
      const analytics = getAnalytics(app);
      const db = getFirestore(app);

      // ì „ì—­ ë³€ìˆ˜ë¡œ Firebase ì¸ìŠ¤í„´ìŠ¤ ì €ì¥
      window.firebaseApp = app;
      window.firebaseDB = db;
      window.firebaseAnalytics = analytics;
      window.addDoc = addDoc;
      window.collection = collection;
      window.serverTimestamp = serverTimestamp;
    </script>
</head>
<body>
    <div class="container">
        <header>
            <h1>ìš°ì£¼ì˜ ê³„ì‚°ê¸° VER.3</h1>
            <div class="admin-controls">
                <button type="button" id="toggleVisitorInfo" class="btn btn-admin">ê´€ë¦¬ì ëª¨ë“œ</button>
            </div>
        </header>

        <main>
            <!-- íƒ­ ë„¤ë¹„ê²Œì´ì…˜ -->
            <div class="tab-navigation">
                <button type="button" class="tab-button active" data-tab="manual">ìˆ˜ë™ ì…ë ¥</button>
                <button type="button" class="tab-button" data-tab="excel">ì—‘ì…€ ë°ì´í„° ì…ë ¥</button>
            </div>

            <!-- ìˆ˜ë™ ì…ë ¥ íƒ­ -->
            <div class="tab-content active" id="manual-tab">
                <!-- ì…ë ¥ ì„¹ì…˜ -->
                <section class="input-section">
                    <h2>ê¸°ë³¸ ì„¤ì •</h2>
                    
                    <!-- ìƒì‚° ë¼ì¸ ì„ íƒê³¼ ì”ì—… ì„ íƒì„ í•œ ì¤„ì— ë°°ì¹˜ -->
                    <div class="form-row">
                        <!-- ìƒì‚° ë¼ì¸ ì„ íƒ -->
                        <div class="form-group compact">
                            <label>ìƒì‚° ë¼ì¸ ì„ íƒ</label>
                            <div class="radio-group horizontal">
                                <label class="radio-item compact">
                                    <input type="radio" name="productionLine" value="AB" checked>
                                    <span class="radio-custom"></span>
                                    A/B ë¼ì¸
                                </label>
                                <label class="radio-item compact">
                                    <input type="radio" name="productionLine" value="CD">
                                    <span class="radio-custom"></span>
                                    C/D ë¼ì¸
                                </label>
                                <label class="radio-item compact">
                                    <input type="radio" name="productionLine" value="E">
                                    <span class="radio-custom"></span>
                                    E ë¼ì¸
                                </label>
                            </div>
                        </div>

                        <!-- ì”ì—… ì„ íƒ -->
                        <div class="form-group compact">
                            <label>ì”ì—… ì„ íƒ</label>
                            <div class="radio-group horizontal">
                                <label class="radio-item compact">
                                    <input type="radio" name="overtime" value="0" checked>
                                    <span class="radio-custom"></span>
                                    ë¯¸ì”ì—…
                                </label>
                                <label class="radio-item compact">
                                    <input type="radio" name="overtime" value="1">
                                    <span class="radio-custom"></span>
                                    1ì‹œê°„ ì”ì—…
                                </label>
                                <label class="radio-item compact">
                                    <input type="radio" name="overtime" value="2">
                                    <span class="radio-custom"></span>
                                    2ì‹œê°„ ì”ì—…
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- ì‹œì‘ ì‹œê°„ê³¼ ì¢…ë£Œ ì‹œê°„ì„ í•œ ì¤„ì— ë°°ì¹˜ -->
                    <div class="form-row">
                        <!-- ì‹œì‘ ì‹œê°„ ì…ë ¥ -->
                        <div class="form-group compact">
                            <label for="startTime">ì‹œì‘ ì‹œê°„</label>
                            <div class="time-input-group">
                                <input type="time" id="startTime" value="08:30" required>
                                <button type="button" id="resetStartTime" class="btn-reset" title="ê¸°ë³¸ê°’ìœ¼ë¡œ ì´ˆê¸°í™”">â†º</button>
                            </div>
                            <!-- ì‹œê°„ëŒ€ ì„ íƒ ë²„íŠ¼ë“¤ -->
                            <div class="time-period-buttons">
                                <button type="button" class="btn-time-period" data-period="A_TIME">Aíƒ€ì„</button>
                                <button type="button" class="btn-time-period" data-period="B_TIME">Bíƒ€ì„</button>
                                <button type="button" class="btn-time-period" data-period="C_TIME">Cíƒ€ì„</button>
                                <button type="button" class="btn-time-period" data-period="D_TIME">Díƒ€ì„</button>
                                <button type="button" class="btn-time-period" data-period="E_TIME">Eíƒ€ì„</button>
                            </div>
                        </div>

                        <!-- ì¢…ë£Œ ì‹œê°„ ì…ë ¥ -->
                        <div class="form-group compact">
                            <label for="endTime">ì¢…ë£Œ ì‹œê°„ (ì„ íƒì‚¬í•­)</label>
                            <div class="time-input-group">
                                <input type="time" id="endTime" placeholder="ì¢…ë£Œ ì‹œê°„ì„ ì…ë ¥í•˜ë©´ ìƒì‚° ê°€ëŠ¥ ìˆ˜ëŸ‰ì„ ê³„ì‚°í•©ë‹ˆë‹¤">
                                <button type="button" id="resetEndTime" class="btn-reset" title="ì´ˆê¸°í™”">â†º</button>
                            </div>
                            <small class="form-help">ì¢…ë£Œ ì‹œê°„ì„ ì…ë ¥í•˜ë©´ í•´ë‹¹ ì‹œê°„ê¹Œì§€ ìƒì‚° ê°€ëŠ¥í•œ ìˆ˜ëŸ‰ì„ ê³„ì‚°í•©ë‹ˆë‹¤.</small>
                        </div>
                    </div>
                </section>

                <!-- ëª¨ë¸ ì…ë ¥ ì„¹ì…˜ -->
                <section class="models-section">
                    <h2>ëª¨ë¸ ì •ë³´</h2>
                    <div id="modelsContainer">
                        <!-- ê¸°ë³¸ 1ê°œ ëª¨ë¸ ì…ë ¥ í¼ -->
                    </div>
                    <button type="button" id="addModel" class="btn btn-secondary">ëª¨ë¸ ì¶”ê°€</button>
                </section>

                <!-- ê³„ì‚° ë²„íŠ¼ -->
                <div class="calculate-section">
                    <button type="button" id="calculateBtn" class="btn btn-primary">ìƒì‚° ì‹œê°„ ê³„ì‚°</button>
                </div>
            </div>

            <!-- ì—‘ì…€ ë°ì´í„° ì…ë ¥ íƒ­ -->
            <div class="tab-content" id="excel-tab">
                <!-- ì—‘ì…€ ì…ë ¥ ì„¹ì…˜ -->
                <section class="input-section">
                    <h2>ê¸°ë³¸ ì„¤ì •</h2>
                    
                    <!-- ìƒì‚° ë¼ì¸ ì„ íƒê³¼ ì”ì—… ì„ íƒì„ í•œ ì¤„ì— ë°°ì¹˜ -->
                    <div class="form-row">
                        <!-- ìƒì‚° ë¼ì¸ ì„ íƒ -->
                        <div class="form-group compact">
                            <label>ìƒì‚° ë¼ì¸ ì„ íƒ</label>
                            <div class="radio-group horizontal">
                                <label class="radio-item compact">
                                    <input type="radio" name="excelProductionLine" value="AB" checked>
                                    <span class="radio-custom"></span>
                                    A/B ë¼ì¸
                                </label>
                                <label class="radio-item compact">
                                    <input type="radio" name="excelProductionLine" value="CD">
                                    <span class="radio-custom"></span>
                                    C/D ë¼ì¸
                                </label>
                                <label class="radio-item compact">
                                    <input type="radio" name="excelProductionLine" value="E">
                                    <span class="radio-custom"></span>
                                    E ë¼ì¸
                                </label>
                            </div>
                        </div>

                        <!-- ì”ì—… ì„ íƒ -->
                        <div class="form-group compact">
                            <label>ì”ì—… ì„ íƒ</label>
                            <div class="radio-group horizontal">
                                <label class="radio-item compact">
                                    <input type="radio" name="excelOvertime" value="0" checked>
                                    <span class="radio-custom"></span>
                                    ë¯¸ì”ì—…
                                </label>
                                <label class="radio-item compact">
                                    <input type="radio" name="excelOvertime" value="1">
                                    <span class="radio-custom"></span>
                                    1ì‹œê°„ ì”ì—…
                                </label>
                                <label class="radio-item compact">
                                    <input type="radio" name="excelOvertime" value="2">
                                    <span class="radio-custom"></span>
                                    2ì‹œê°„ ì”ì—…
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- ì‹œì‘ ì‹œê°„ê³¼ ì¢…ë£Œ ì‹œê°„ì„ í•œ ì¤„ì— ë°°ì¹˜ -->
                    <div class="form-row">
                        <!-- ì‹œì‘ ì‹œê°„ ì…ë ¥ -->
                        <div class="form-group compact">
                            <label for="excelStartTime">ì‹œì‘ ì‹œê°„</label>
                            <div class="time-input-group">
                                <input type="time" id="excelStartTime" value="08:30" required>
                                <button type="button" id="excelResetStartTime" class="btn-reset" title="ê¸°ë³¸ê°’ìœ¼ë¡œ ì´ˆê¸°í™”">â†º</button>
                            </div>
                            <!-- ì‹œê°„ëŒ€ ì„ íƒ ë²„íŠ¼ë“¤ -->
                            <div class="time-period-buttons">
                                <button type="button" class="btn-time-period-excel" data-period="A_TIME">Aíƒ€ì„</button>
                                <button type="button" class="btn-time-period-excel" data-period="B_TIME">Bíƒ€ì„</button>
                                <button type="button" class="btn-time-period-excel" data-period="C_TIME">Cíƒ€ì„</button>
                                <button type="button" class="btn-time-period-excel" data-period="D_TIME">Díƒ€ì„</button>
                                <button type="button" class="btn-time-period-excel" data-period="E_TIME">Eíƒ€ì„</button>
                            </div>
                        </div>

                        <!-- ì¢…ë£Œ ì‹œê°„ ì…ë ¥ -->
                        <div class="form-group compact">
                            <label for="excelEndTime">ì¢…ë£Œ ì‹œê°„ (ì„ íƒì‚¬í•­)</label>
                            <div class="time-input-group">
                                <input type="time" id="excelEndTime" placeholder="ì¢…ë£Œ ì‹œê°„ì„ ì…ë ¥í•˜ë©´ ìƒì‚° ê°€ëŠ¥ ìˆ˜ëŸ‰ì„ ê³„ì‚°í•©ë‹ˆë‹¤">
                                <button type="button" id="excelResetEndTime" class="btn-reset" title="ì´ˆê¸°í™”">â†º</button>
                            </div>
                            <small class="form-help">ì¢…ë£Œ ì‹œê°„ì„ ì…ë ¥í•˜ë©´ í•´ë‹¹ ì‹œê°„ê¹Œì§€ ìƒì‚° ê°€ëŠ¥í•œ ìˆ˜ëŸ‰ì„ ê³„ì‚°í•©ë‹ˆë‹¤.</small>
                        </div>
                    </div>
                </section>

                <!-- ì—‘ì…€ ë°ì´í„° ì…ë ¥ ì„¹ì…˜ -->
                <section class="excel-section">
                    <h2>ì—‘ì…€ ë°ì´í„° ì…ë ¥</h2>
                    <div class="excel-instructions">
                        <p><strong>ğŸ“‹ ì‚¬ìš© ë°©ë²•:</strong></p>
                        <ol>
                            <li>ì—‘ì…€ì—ì„œ ëª¨ë¸ëª…ê³¼ ìˆ˜ëŸ‰ì´ ìˆëŠ” 2ì—´ xí–‰ ë°ì´í„°ë¥¼ ë³µì‚¬í•˜ì„¸ìš”</li>
                            <li>ì•„ë˜ í…ìŠ¤íŠ¸ ì˜ì—­ì— ë¶™ì—¬ë„£ê¸° í•˜ì„¸ìš”</li>
                            <li>ê° ëª¨ë¸ì˜ ST(ì´ˆ)ì™€ ë¼ì¸êµì²´ì‹œê°„(ë¶„)ì„ ì…ë ¥í•˜ì„¸ìš”</li>
                        </ol>
                    </div>
                    
                    <div class="excel-input-container">
                        <div class="excel-textarea-group">
                            <label for="excelData">ì—‘ì…€ ë°ì´í„° (ëª¨ë¸ëª…ê³¼ ìˆ˜ëŸ‰)</label>
                            <textarea id="excelData" placeholder="ì—‘ì…€ì—ì„œ ë³µì‚¬í•œ ë°ì´í„°ë¥¼ ì—¬ê¸°ì— ë¶™ì—¬ë„£ìœ¼ì„¸ìš”&#10;ì˜ˆì‹œ:&#10;ëª¨ë¸A	100&#10;ëª¨ë¸B	200&#10;ëª¨ë¸C	150" rows="8"></textarea>
                        </div>
                        
                        <div class="excel-models-container" id="excelModelsContainer">
                            <!-- ì—‘ì…€ ëª¨ë¸ ì…ë ¥ í¼ë“¤ì´ ì—¬ê¸°ì— ìƒì„±ë©ë‹ˆë‹¤ -->
                        </div>
                        
                        <button type="button" id="parseExcelData" class="btn btn-primary">STì…ë ¥ ë„˜ì–´ê°€ê¸°</button>
                    </div>
                </section>

                <!-- ê³„ì‚° ë²„íŠ¼ -->
                <div class="calculate-section">
                    <button type="button" id="calculateExcelBtn" class="btn btn-primary">ìƒì‚° ì‹œê°„ ê³„ì‚°</button>
                </div>
            </div>

            <!-- í˜„ì¬ì‹œê°„ í™•ì¸ ë²„íŠ¼ê³¼ ê²°ê³¼ ì§€ìš°ê¸° ë²„íŠ¼ (ê²°ê³¼ í‘œì‹œ í›„ì—ë§Œ ë‚˜íƒ€ë‚¨) -->
            <div class="current-time-section" id="currentTimeSection" style="display: none;">
                <div class="current-time-buttons">
                    <button type="button" id="checkCurrentTimeBtn" class="btn btn-secondary">í˜„ì¬ì‹œê°„ê¹Œì§€ ìƒì‚°ëŸ‰ í™•ì¸</button>
                    <button type="button" id="clearResultsBtn" class="btn btn-danger">ê²°ê³¼ ì§€ìš°ê¸°</button>
                </div>
            </div>

            <!-- ê²°ê³¼ ì„¹ì…˜ -->
            <section class="results-section" id="resultsSection" style="display: none;">
                <h2>ìƒì‚° ìŠ¤ì¼€ì¤„ ê²°ê³¼</h2>
                <div id="resultsContainer"></div>
            </section>
        </main>
    </div>

    <script src="script.js"></script>
</body>
</html> 